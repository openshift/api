apiVersion: apiextensions.k8s.io/v1 # Hack because controller-gen complains if we don't have this
name: "[Custom] PinnedImageSet"
crd: 0000_80_pinnedimageset-TechPreviewNoUpgrade.crd.yaml
tests:
  onCreate:
  - name: Should be able to create a minimal PinnedImageSet
    initial: |
      apiVersion: machineconfiguration.openshift.io/v1alpha1
      kind: PinnedImageSet
      metadata:
        name: test-pinnedimageset
      spec:
        pinnedImages:
          - example.io/my-project/image-v1.0_23@sha256:2c3ea52ac3a41c6d58e85977c3149413e3fa4b70eb2397426456863adbf43306
          - example.com:5000/project/image@sha256:abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890
          - example.com/image@sha256:abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890
          - my-registry.local/project/my-image@sha256:1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef
    expected: |
      apiVersion: machineconfiguration.openshift.io/v1alpha1
      kind: PinnedImageSet
      metadata:
        name: test-pinnedimageset
      spec:
        pinnedImages:
          - example.io/my-project/image-v1.0_23@sha256:2c3ea52ac3a41c6d58e85977c3149413e3fa4b70eb2397426456863adbf43306
          - example.com:5000/project/image@sha256:abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890
          - example.com/image@sha256:abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890
          - my-registry.local/project/my-image@sha256:1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef